<!DOCTYPE html>
<html lang="en">
<!-- Previous head content remains the same -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IT Hardware Inventory</title>
    <link rel="stylesheet" href="static/styles.css">
    <!-- AG Grid Community Edition -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ag-grid-community@29.3.5/styles/ag-grid.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ag-grid-community@29.3.5/styles/ag-theme-alpine.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ag-grid-community@29.3.5/styles/ag-theme-alpine-dark.min.css">
    <script src="https://cdn.jsdelivr.net/npm/ag-grid-community@29.3.5/dist/ag-grid-community.min.js"></script>
</head>
<body>
    <!-- Previous body content remains the same until after the AG Grid div -->
    <div class="top-buttons">
        <!-- Previous content -->
    </div>
    <div class="container">
        <h1>IT Hardware Inventory</h1>
        <!-- Previous content until AG Grid -->
        
        <!-- AG Grid -->
        <div id="myGrid" class="ag-theme-alpine" style="height: 600px; width: 100%;"></div>
        
        <!-- Custom Pagination -->
        <div class="pagination">
            <button id="prevPage" class="page-button">&lt; Previous</button>
            <span id="pageInfo">Page 1</span>
            <button id="nextPage" class="page-button">Next &gt;</button>
        </div>

        <!-- Previous modals and content remain the same -->
    </div>

    <script>
        let currentPage = 1;
        let totalPages = 1;
        
        // Previous JavaScript remains the same until gridOptions
        const gridOptions = {
            columnDefs: columnDefs,
            defaultColDef: {
                flex: 1,
                minWidth: 100,
                resizable: true,
                sortable: true,
                filter: true
            },
            rowData: [],
            pagination: false, // Disable AG Grid's pagination
            suppressRowClickSelection: true,
            rowSelection: 'single',
            onGridReady: (params) => {
                gridApi = params.api;
                columnApi = params.columnApi;
                
                // Load saved column state
                const savedState = localStorage.getItem('gridState');
                if (savedState) {
                    columnApi.applyColumnState(JSON.parse(savedState));
                }
                
                // Initial data load
                loadInventory(1);
            },
            onRowClicked: (params) => showDetails(params.data),
            getRowHeight: () => 40
        };

        // Load inventory data
        async function loadInventory(page = 1) {
            currentPage = page;
            const params = new URLSearchParams({
                page: page,
                site_name: document.getElementById('filterSiteName')?.value || '',
                room_number: document.getElementById('filterRoomNumber')?.value || '',
                room_name: document.getElementById('filterRoomName')?.value || '',
                asset_tag: document.getElementById('filterAssetTag')?.value || '',
                asset_type: document.getElementById('filterAssetType')?.value || '',
                model: document.getElementById('filterModel')?.value || '',
                serial_number: document.getElementById('filterSerialNumber')?.value || '',
                assigned_to: document.getElementById('filterAssignedTo')?.value || '',
                date_assigned_from: document.getElementById('filterDateAssignedFrom')?.value || '',
                date_assigned_to: document.getElementById('filterDateAssignedTo')?.value || '',
                date_decommissioned_from: document.getElementById('filterDateDecommissionedFrom')?.value || '',
                date_decommissioned_to: document.getElementById('filterDateDecommissionedTo')?.value || ''
            });

            try {
                const response = await fetch(`/api/hardware?${params.toString()}`);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const data = await response.json();
                if (Array.isArray(data.items)) {
                    gridApi.setRowData(data.items);
                    totalPages = Math.ceil(data.total_items / 35); // 35 items per page
                    updatePaginationControls();
                }
            } catch (error) {
                console.error('Error loading inventory:', error);
            }
        }

        function updatePaginationControls() {
            document.getElementById('pageInfo').textContent = `Page ${currentPage} of ${totalPages}`;
            document.getElementById('prevPage').disabled = currentPage <= 1;
            document.getElementById('nextPage').disabled = currentPage >= totalPages;
        }

        // Initialize Grid
        document.addEventListener('DOMContentLoaded', () => {
            const gridDiv = document.querySelector('#myGrid');
            new agGrid.Grid(gridDiv, gridOptions);

            // Pagination event listeners
            document.getElementById('prevPage').addEventListener('click', () => {
                if (currentPage > 1) {
                    loadInventory(currentPage - 1);
                }
            });

            document.getElementById('nextPage').addEventListener('click', () => {
                if (currentPage < totalPages) {
                    loadInventory(currentPage + 1);
                }
            });

            // Rest of the initialization code remains the same
        });

        // Rest of the JavaScript remains exactly the same
    </script>
</body>
</html>
